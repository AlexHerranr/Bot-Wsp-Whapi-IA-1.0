<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="color-scheme" content="light dark">
<title>{{documentType}} – {{bookingId}}</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<style>
  :root {
    --primary: #1e40af;
    --primary-600: #1d4ed8;
    --primary-light: #3b82f6;
    --secondary: #0f172a;
    --accent: #f1f5f9;
    --gold: #f59e0b;
    --success: #059669;
    --danger: #dc2626;
    --text-primary: #0f172a;
    --text-secondary: #475569;
    --text-muted: #64748b;
    --border: #e2e8f0;
    --bg: #f6f7fb;
    --bg-card: #ffffff;
    --gradient-primary: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
    --gradient-accent: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
    --shadow-sm: 0 1px 3px 0 rgba(0,0,0,.08);
    --shadow-md: 0 4px 10px rgba(0,0,0,.10);
    --shadow-lg: 0 16px 30px rgba(2,6,23,.14);
  }

  * { box-sizing: border-box; }
  html, body { height: 100%; }
  body {
    margin: 0;
    font-family: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, 'Apple Color Emoji', 'Segoe UI Emoji';
    background: radial-gradient(1200px 600px at 10% -10%, #eef2ff 0%, transparent 60%),
                radial-gradient(1000px 500px at 110% 10%, #eff6ff 0%, transparent 60%),
                var(--bg);
    color: var(--text-primary);
    line-height: 1.6;
    -webkit-font-smoothing: antialiased;
    padding: 20px 0;
  }

  .document {
    max-width: 880px;
    margin: 0 auto;
    background: var(--bg-card);
    border-radius: 18px;
    overflow: hidden;
    box-shadow: var(--shadow-lg);
    position: relative;
    border: 1px solid rgba(15,23,42,.06);
  }

  /* ===== Header ===== */
  .header {
    background: var(--primary);
    color: #fff;
    padding: 24px;
    position: relative;
    overflow: hidden;
  }
  
  .header-split {
    display: grid;
    grid-template-columns: 40% 60%;
    border-radius: 16px;
    overflow: hidden;
    box-shadow: var(--shadow-md);
    border-bottom: 4px solid var(--gold);
  }
  
  .header-logo-pane {
    background: #fff;
    padding: 1.5rem;
    display: grid;
    place-content: center;
  }
  
  .header-logo-pane img {
    max-width: 100%;
    max-height: 80px;
    height: auto;
    object-fit: contain;
  }

  .header-title-pane {
    background: var(--primary-light);
    color: #fff;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    padding: 1.5rem;
    text-align: center;
  }

  .header-title-pane h2 {
    margin: 0 0 0.5rem 0;
    font-size: 1.75rem;
    font-weight: 700;
  }

  .booking-code-display {
    margin: 0;
    font-size: 1.1rem;
    opacity: 0.9;
    font-weight: 500;
  }

  .toolbar {
    margin-top: 1rem;
    display: none; /* Oculto para PDF */
  }

  /* ===== Content ===== */
  .content {
    padding: 2rem;
  }

  .status-wrap {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 2rem;
  }

  .status-badge {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    background: var(--success);
    color: white;
    padding: 0.75rem 1.5rem;
    border-radius: 50px;
    font-weight: 600;
    font-size: 1rem;
  }

  .qr {
    width: 80px;
    height: 80px;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: var(--shadow-sm);
  }

  .qr img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* ===== Sections ===== */
  .section {
    margin-bottom: 2rem;
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 1.5rem;
    box-shadow: var(--shadow-sm);
  }

  .section-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 1.25rem;
  }

  .section-icon {
    width: 40px;
    height: 40px;
    background: var(--gradient-primary);
    color: white;
    border-radius: 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
  }

  .section-title {
    margin: 0;
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
  }

  .info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1rem;
  }

  .info-item {
    padding: 0.75rem 0;
  }

  .info-label {
    font-size: 0.875rem;
    color: var(--text-muted);
    margin-bottom: 0.25rem;
    font-weight: 500;
  }

  .info-value {
    font-size: 1rem;
    color: var(--text-primary);
    font-weight: 600;
  }

  .info-note {
    font-size: 0.875rem;
    color: var(--text-secondary);
    margin-top: 0.25rem;
    font-style: italic;
  }

  /* ===== Date Cards ===== */
  .dates-section {
    background: var(--gradient-accent);
    border: 2px solid var(--primary);
  }

  .date-cards {
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 1rem;
  }

  .date-card {
    flex: 1;
    text-align: center;
    background: white;
    padding: 1.25rem;
    border-radius: 16px;
    box-shadow: var(--shadow-sm);
  }

  .date-card h4 {
    margin: 0 0 0.5rem 0;
    font-size: 0.875rem;
    color: var(--text-muted);
    text-transform: uppercase;
    font-weight: 600;
    letter-spacing: 0.05em;
  }

  .date-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: var(--text-primary);
    margin-bottom: 0.25rem;
  }

  .date-note {
    font-size: 0.75rem;
    color: var(--text-secondary);
  }

  .duration-badge {
    background: var(--gold);
    color: white;
    padding: 1rem 1.5rem;
    border-radius: 50px;
    font-weight: 700;
    font-size: 1.1rem;
    text-align: center;
    box-shadow: var(--shadow-md);
    flex-shrink: 0;
  }

  /* ===== Payment Table ===== */
  .table-wrap {
    overflow: hidden;
    border-radius: 12px;
    border: 1px solid var(--border);
  }

  .payment-table {
    width: 100%;
    border-collapse: collapse;
  }

  .payment-table th {
    background: var(--primary);
    color: white;
    padding: 1rem;
    font-weight: 600;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .payment-table td {
    padding: 0.875rem 1rem;
    border-bottom: 1px solid var(--border);
  }

  .payment-table tr:last-child td {
    border-bottom: none;
  }

  .total-row {
    background: var(--accent);
    font-weight: 700;
  }

  .amount {
    font-family: 'Inter', monospace;
    font-weight: 600;
  }

  .amount.positive {
    color: var(--success);
  }

  .amount.negative {
    color: var(--danger);
  }

  .table-note {
    padding: 1rem;
    background: var(--accent);
    font-size: 0.875rem;
    color: var(--text-secondary);
    text-align: center;
  }

  /* ===== Policy Section ===== */
  .policy-section {
    background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
    border: 2px solid var(--gold);
  }

  .policy-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .policy-list li {
    margin-bottom: 0.75rem;
    padding-left: 1.5rem;
    position: relative;
    font-size: 0.9rem;
    line-height: 1.5;
  }

  .policy-list li::before {
    content: "•";
    color: var(--gold);
    font-weight: bold;
    position: absolute;
    left: 0;
  }

  /* ===== Footer ===== */
  .footer {
    background: var(--secondary);
    color: white;
    padding: 2rem;
    text-align: center;
  }

  .footer-content {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 2rem;
    margin-bottom: 1rem;
  }

  .footer-section h4 {
    margin: 0 0 0.5rem 0;
    font-size: 1rem;
    font-weight: 600;
    color: var(--gold);
  }

  .footer-section p {
    margin: 0.25rem 0;
    font-size: 0.875rem;
    opacity: 0.9;
  }

  .footer-bottom {
    border-top: 1px solid rgba(255,255,255,0.1);
    padding-top: 1rem;
    font-size: 0.75rem;
    opacity: 0.7;
  }

  /* PDF optimizations */
  @media print {
    body { 
      padding: 0; 
      background: white;
    }
    .document {
      box-shadow: none;
      border: none;
      max-width: 100%;
    }
    .toolbar {
      display: none !important;
    }
  }
</style>
</head>
<body>
  <div class="document" role="document" aria-label="{{documentType}}">
    <!-- ===== HEADER ===== -->
    <header class="header">
      <div class="header-split">
        <div class="header-logo-pane">
          <img src="https://static.wixstatic.com/media/9d70be_89482391d42842e3b42d61b34fdaf7b6~mv2.png/v1/crop/x_249,y_397,w_8078,h_2556/fill/w_393,h_121,al_c,q_85,usm_0.66_1.00_0.01,enc_auto/COMPLETO%20PNG.png" 
               alt="{{companyInfo.name}}" 
               onerror="this.style.display='none';" />
        </div>
        <div class="header-title-pane">
          <h2>{{documentType}}</h2>
          <p class="booking-code-display">Reserva #{{bookingId}}</p>
        </div>
      </div>
    </header>

    <!-- ===== CONTENT ===== -->
    <main class="content">
      <div class="status-wrap">
        <div class="status-badge">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
            <polyline points="22 4 12 14.01 9 11.01"></polyline>
          </svg>
          {{#if bookingStatus}}{{bookingStatus}}{{else}}Reserva Procesada{{/if}}
        </div>
        <div class="qr" aria-label="Código QR para contactar por WhatsApp">
          <img alt="QR de contacto por WhatsApp" 
               src="https://api.qrserver.com/v1/create-qr-code/?size=80x80&data={{qrData}}" 
               onerror="this.style.display='none';" />
        </div>
      </div>

      <!-- Huésped -->
      <section class="section" aria-labelledby="guest-title">
        <div class="section-header">
          <div class="section-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
          </div>
          <h3 class="section-title" id="guest-title">Información del Huésped</h3>
        </div>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-label">Nombre Completo</div>
            <div class="info-value">{{guestName}}</div>
          </div>
          <div class="info-item">
            <div class="info-label">Número de Huéspedes</div>
            <div class="info-value">{{guestCount}}</div>
          </div>
          {{#if phone}}
          <div class="info-item">
            <div class="info-label">Teléfono</div>
            <div class="info-value">{{phone}}</div>
          </div>
          {{/if}}
          {{#if email}}
          <div class="info-item">
            <div class="info-label">Correo Electrónico</div>
            <div class="info-value">{{email}}</div>
          </div>
          {{/if}}
        </div>
      </section>

      <!-- Estadía -->
      <section class="section" aria-labelledby="stay-title">
        <div class="section-header">
          <div class="section-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M10 22H5a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h5"></path>
              <path d="M17 14h-7"></path>
              <path d="M21 10h-11"></path>
              <path d="M21 6h-11"></path>
              <path d="M7 20.5V3.5"></path>
            </svg>
          </div>
          <h3 class="section-title" id="stay-title">Detalles de la Estadía</h3>
        </div>
        <div class="info-grid">
          <div class="info-item">
            <div class="info-label">Apartamento</div>
            <div class="info-value">{{roomName}}</div>
            <div class="info-note">Vista al mar • Balcón privado • WiFi gratuito</div>
          </div>
        </div>
      </section>

      <!-- Fechas -->
      <section class="section dates-section" aria-labelledby="dates-title">
        <div class="section-header">
          <div class="section-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
          </div>
          <h3 class="section-title" id="dates-title">Fechas de Estadía</h3>
        </div>
        <div class="date-cards">
          <div class="date-card">
            <h4>Check-in</h4>
            <div class="date-value">{{checkInDateFormatted}}</div>
            <div class="date-note">A partir de las 3:00 p.m.</div>
          </div>
          <div class="duration-badge">{{nights}} noche{{#if multipleNights}}s{{/if}}</div>
          <div class="date-card">
            <h4>Check-out</h4>
            <div class="date-value">{{checkOutDateFormatted}}</div>
            <div class="date-note">Hasta las 11:45 a.m.</div>
          </div>
        </div>
      </section>

      <!-- Pagos -->
      <section class="section" aria-labelledby="payment-title">
        <div class="section-header">
          <div class="section-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="1" y="4" width="22" height="16" rx="2" ry="2"></rect>
              <line x1="1" y1="10" x2="23" y2="10"></line>
            </svg>
          </div>
          <h3 class="section-title" id="payment-title">Desglose del Pago</h3>
        </div>
        <div class="table-wrap">
          <table class="payment-table">
            <thead>
              <tr>
                <th style="width:50%">Descripción</th>
                <th style="width:15%; text-align:center">Cantidad</th>
                <th style="width:17.5%; text-align:right">Precio</th>
                <th style="width:17.5%; text-align:right">Total</th>
              </tr>
            </thead>
            <tbody>
              {{#each invoiceItems}}
              <tr>
                <td>{{description}}</td>
                <td style="text-align:center">{{quantity}}</td>
                <td style="text-align:right">{{unitPrice}}</td>
                <td style="text-align:right" class="amount {{#if isNegative}}negative{{else}}positive{{/if}}">
                  <strong>{{totalAmount}}</strong>
                </td>
              </tr>
              {{/each}}
              <tr class="total-row">
                <td><strong>Total General</strong></td>
                <td></td>
                <td></td>
                <td style="text-align:right" class="amount">
                  <strong>{{totalCharges}}</strong>
                </td>
              </tr>
              {{#if totalPaid}}
              <tr class="total-row">
                <td><strong>Saldo Pendiente</strong></td>
                <td></td>
                <td></td>
                <td style="text-align:right" class="amount">
                  <strong>{{balance}}</strong>
                </td>
              </tr>
              {{/if}}
            </tbody>
          </table>
          {{#if paymentNote}}
          <div class="table-note">{{paymentNote}}</div>
          {{/if}}
        </div>
      </section>

      <!-- Política -->
      <section class="section policy-section" aria-labelledby="policy-title">
        <div class="section-header">
          <div class="section-icon" aria-hidden="true">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
              <line x1="12" y1="9" x2="12" y2="13"></line>
              <line x1="12" y1="17" x2="12.01" y2="17"></line>
            </svg>
          </div>
          <h3 class="section-title" id="policy-title">Política de Cancelación</h3>
        </div>
        <ul class="policy-list">
          <li>Pueden cancelar hasta 15 días antes de la llegada y recibir un reembolso del 50% del valor total del anticipo.</li>
          <li>La cancelación debe realizarse 15 días completos antes de la hora local de llegada al apartamento.</li>
          <li>No incluye alimentación ni limpieza diaria.</li>
          <li>Para consultas: WhatsApp {{companyInfo.whatsapp}} • Email {{companyInfo.email}}</li>
        </ul>
      </section>
    </main>

    <!-- ===== FOOTER ===== -->
    <footer class="footer">
      <div class="footer-content">
        <div class="footer-section">
          <h4>{{companyInfo.name}}</h4>
          <p>NIT: {{companyInfo.nit}}</p>
          <p>{{companyInfo.address}}</p>
        </div>
        <div class="footer-section">
          <h4>Contacto</h4>
          <p>Tel: {{companyInfo.phone}}</p>
          <p>WhatsApp: {{companyInfo.whatsapp}}</p>
          <p>Email: {{companyInfo.email}}</p>
        </div>
        <div class="footer-section">
          <h4>Sitio Web</h4>
          <p>{{companyInfo.website}}</p>
          <p>Cartagena, Colombia</p>
        </div>
      </div>
      <div class="footer-bottom">
        <p>Documento generado el {{currentDate}}</p>
      </div>
    </footer>
  </div>
</body>
</html>